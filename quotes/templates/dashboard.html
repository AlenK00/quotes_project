{% extends 'base.html' %}

{% block title %}Дашборд цитат{% endblock %}

{% block header %}📊 Дашборд цитат{% endblock %}

{% block content %}
<div class="stats">
    <div class="stat-card">
        <h3>📝 Всего цитат</h3>
        <p>{{ total_quotes }}</p>
    </div>
    <div class="stat-card">
        <h3>🎬 Источников</h3>
        <p>{{ total_sources }}</p>
    </div>
    <div class="stat-card">
        <h3>👀 Просмотров</h3>
        <p>{{ total_views }}</p>
    </div>
    <div class="stat-card">
        <h3>👍 Лайков</h3>
        <p>{{ total_likes }}</p>
    </div>
</div>

<div class="filters">
    <h3>🔍 Фильтры</h3>
    <form method="get">
        <div style="display: flex; flex-wrap: wrap; gap: 15px; align-items: center;">
            <div>
                <label>Тип источника:</label>
                <select name="type">
                    <option value="">Все</option>
                    <option value="movie" {% if source_type == "movie" %}selected{% endif %}>🎬 Фильмы</option>
                    <option value="series" {% if source_type == "series" %}selected{% endif %}>📺 Сериалы</option>
                    <option value="book" {% if source_type == "book" %}selected{% endif %}>📚 Книги</option>
                    <option value="song" {% if source_type == "song" %}selected{% endif %}>🎵 Песни</option>
                    <option value="game" {% if source_type == "game" %}selected{% endif %}>🎮 Игры</option>
                    <option value="poem" {% if source_type == "poem" %}selected{% endif %}>📝 Стихи</option>
                    <option value="speech" {% if source_type == "speech" %}selected{% endif %}>🎤 Выступления</option>
                    <option value="social" {% if source_type == "social" %}selected{% endif %}>📱 Соцсети</option>
                    <option value="proverb" {% if source_type == "proverb" %}selected{% endif %}>💬 Пословицы</option>
                    <option value="other" {% if source_type == "other" %}selected{% endif %}>❓ Другое</option>
                </select>
            </div>
            
            <div>
                <label>Мин. лайков:</label>
                <input type="number" name="min_likes" value="{{ min_likes }}" min="0" style="width: 80px;">
            </div>
            
            <div>
                <button type="submit" class="btn" style="padding: 8px 20px;">Применить</button>
                <a href="{% url 'dashboard' %}" style="margin-left: 10px;">Сбросить</a>
            </div>
        </div>
    </form>
</div>

<h2 style="text-align: center; margin: 30px 0 20px 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px;">📈 Популярные цитаты</h2>
{% for quote in filtered_quotes %}
<div class="quote-card">
    <p class="quote-text">"{{ quote.text }}"</p>
    <p class="quote-source"><strong>Источник:</strong> {{ quote.source.name }} ({{ quote.source.get_type_display }})</p>
    <div class="quote-stats">
        <span>👍 {{ quote.likes }}</span>
        <span>👎 {{ quote.dislikes }}</span>
        <span>👀 {{ quote.views }}</span>
        <span>⚖️ {{ quote.weight }}</span>
    </div>
    <div style="margin-top: 15px;">
        <a href="{% url 'edit_quote' quote.id %}" class="btn" style="padding: 8px 20px; font-size: 0.9em;">✏️ Изменить вес</a>
    </div>
</div>
{% empty %}
<div class="quote-card">
    <p class="quote-text">Нет цитат по выбранным фильтрам</p>
</div>
{% endfor %}

<h2 style="text-align: center; margin: 40px 0 20px 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px;">🏆 Топ источников</h2>
{% for source in popular_sources %}
<div class="quote-card">
    <p class="quote-text"><strong>{{ source.name }}</strong> ({{ source.get_type_display }})</p>
    <div class="quote-stats">
        <span>📝 Цитат: {{ source.total_quotes }}</span>
        <span>👍 Лайков: {{ source.total_likes }}</span>
    </div>
</div>
{% empty %}
<div class="quote-card">
    <p class="quote-text">Нет данных об источниках</p>
</div>
{% endfor %}
{% endblock %}